# –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π –∏–∑ KudaGo API —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã `populate_events`

## üìå –û–ø–∏—Å–∞–Ω–∏–µ

–ö–æ–º–∞–Ω–¥–∞ `populate_events` ‚Äî —ç—Ç–æ Django management-–∫–æ–º–∞–Ω–¥–∞, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω–∞—è –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏–∑ KudaGo Public API –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é –∏–ª–∏ –≤—Ä—É—á–Ω—É—é.

## ‚öôÔ∏è –ß—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥

- –ü–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –∂–∞–Ω—Ä–æ–≤ (`genres`) –∏ –≥–æ—Ä–æ–¥–æ–≤ (`cities`) –∏–∑ KudaGo –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Ö –≤ –º–æ–¥–µ–ª–∏ `Genre` –∏ `City`
- –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–æ (–¥–æ 100 —à—Ç—É–∫ –∑–∞ —Ä–∞–∑)
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–æ–±—ã—Ç–∏—è:
  - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≥–æ—Ä–æ–¥, –∂–∞–Ω—Ä, –º–µ—Å—Ç–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è (`Location`)
  - —Å–æ–∑–¥–∞–µ—Ç –∏–ª–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –æ–±—ä–µ–∫—Ç `Event` —Å –¥–∞–Ω–Ω—ã–º–∏
  - —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è (–µ—Å–ª–∏ –µ—Å—Ç—å)
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –±–µ–∑ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞ —Å—á—ë—Ç `external_id`

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `events/models.py` –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ –º–æ–¥–µ–ª–∏ —Å –Ω—É–∂–Ω—ã–º–∏ –ø–æ–ª—è–º–∏:
   - `Event`: —Å–æ–¥–µ—Ä–∂–∏—Ç `external_id`, `city`, `location`, `genre`, `ticket_price`, `event_date`, `start_time`, `image` –∏ –¥—Ä.
   - `City`, `Genre`, `Location` ‚Äî –º–æ–¥–µ–ª–∏ —Å–æ —Å–≤—è–∑—è–º–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ `events` –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ `INSTALLED_APPS` –≤ `settings.py`:

```python
   INSTALLED_APPS = [
       ...,
       'events',
   ]
````

3. –°–æ–∑–¥–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É Django-–∫–æ–º–∞–Ω–¥—ã:

   ```
   events/
   ‚îî‚îÄ‚îÄ management/
       ‚îî‚îÄ‚îÄ commands/
           ‚îî‚îÄ‚îÄ populate_events.py
   ```

   –í—Å–µ –∫–∞—Ç–∞–ª–æ–≥–∏ (`management`, `commands`) –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø—É—Å—Ç–æ–π `__init__.py`.

4. –í—ã–ø–æ–ª–Ω–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏ (–µ—Å–ª–∏ –≤–Ω–æ—Å–∏–ª–∏—Å—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –º–æ–¥–µ–ª–∏):

   ```bash
   python manage.py makemigrations
   python manage.py migrate
   ```

5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –≤—Ä—É—á–Ω—É—é (—Å–º. –Ω–∏–∂–µ)

---

## üñê –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å –≤—Ä—É—á–Ω—É—é

–í—ã–ø–æ–ª–Ω–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É –∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞:

```bash
python manage.py populate_events
```

–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:

```
Fetching genre mappings...
Genre mapping loaded.
Populating cities...
Successfully populated 6 cities
Populating genres...
Successfully populated 21 genres
Populating events...
Created event: –ù–æ—á—å –º—É–∑–µ–µ–≤ 2025
Event already exists: –í—ã—Å—Ç–∞–≤–∫–∞ –Ω–∞ –í–î–ù–•
Finished populating events
```

---

## ‚è±Ô∏è –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (CRON)

1. –û—Ç–∫—Ä–æ–π—Ç–µ crontab:

   ```bash
   crontab -e
   ```

2. –î–æ–±–∞–≤—å—Ç–µ —Å—Ç—Ä–æ–∫—É –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –∫–æ–º–∞–Ω–¥—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤:

   ```bash
   0 */6 * * * /path/to/venv/bin/python /absolute/path/to/manage.py populate_events >> /var/log/populate_events.log 2>&1
   ```

   –ì–¥–µ:

   * `/path/to/venv/bin/python` ‚Äî –ø—É—Ç—å –¥–æ Python –≤–Ω—É—Ç—Ä–∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
   * `/absolute/path/to/manage.py` ‚Äî –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –ø—É—Ç—å –¥–æ `manage.py` –ø—Ä–æ–µ–∫—Ç–∞
   * `>>` ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç –ª–æ–≥ –≤—ã–≤–æ–¥–∞ –≤ —Ñ–∞–π–ª `/var/log/populate_events.log`

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

* –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤ `settings.py` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã `MEDIA_URL` –∏ `MEDIA_ROOT`, –µ—Å–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `ImageField`.
* –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é –∫–æ–º–∞–Ω–¥—É `cleanup_events`, —É–¥–∞–ª—è—é—â—É—é —Å—Ç–∞—Ä—ã–µ –∏–ª–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ –∑–∞–ø–∏—Å–∏.
* –ù–µ –∑–∞–±—É–¥—å—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –Ω–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –∑–∞–≥—Ä—É–∂–∞–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö, –µ—Å–ª–∏ –±—É–¥–µ—Ç–µ —Ä–∞—Å—à–∏—Ä—è—Ç—å –∫–æ–º–∞–Ω–¥—É.
